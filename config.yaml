# This file will need to use a config file for the port that the service listens on
# make sure we do a helm install stable/postgresql BEFORE any of this since
# the setup requires that we have the postgres database already running 

kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: cluster-job-create
rules: 
- apiGroups: ["", "apps", "batch"]  
  resources: ["configmaps", "persistentvolumeclaims", "pods", "services", "secrets", "deployments", "jobs", "cronjobs"] # what resources this Cluster Role applies to 
  verbs: ["list", "get", "watch", "create", "update", "delete"] # what actions it can perform (right now just list things) 

---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: cluster-create-jobs
subjects:  # who this applies to: all serviceaccounts that are default (which is basically everything)
- kind: User 
  name: fm
  apiGroup: rbac.authorization.k8s.io
- kind: Group
  name: system:serviceaccounts
  apiGroup: rbac.authorization.k8s.io 
roleRef: # what role they are getting  
  kind: ClusterRole 
  name: cluster-job-create
  apiGroup: rbac.authorization.k8s.io

---

apiVersion: v1
kind: PersistentVolume
metadata:
  name: data-pv 
spec: 
  capacity: 
    storage: 30Gi
  accessModes:
    - ReadWriteMany
  hostPath: 
    path: "/mnt/data"

